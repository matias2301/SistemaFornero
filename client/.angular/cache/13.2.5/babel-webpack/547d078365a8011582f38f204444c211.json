{"ast":null,"code":"import { FormGroup, Validators, FormControl } from '@angular/forms';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"../../services/auth.service\";\nimport * as i3 from \"../../services/alerts.service\";\nimport * as i4 from \"@angular/flex-layout/flex\";\nimport * as i5 from \"@angular/material/card\";\nimport * as i6 from \"@angular/material/stepper\";\nimport * as i7 from \"@angular/forms\";\nimport * as i8 from \"@angular/material/form-field\";\nimport * as i9 from \"@angular/material/input\";\nimport * as i10 from \"@angular/common\";\nimport * as i11 from \"@angular/material/checkbox\";\nimport * as i12 from \"@angular/material/button\";\nimport * as i13 from \"@angular/material/icon\";\n\nfunction LoginComponent_ng_template_9_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵtext(0, \"Email\");\n  }\n}\n\nfunction LoginComponent_mat_error_14_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-error\");\n    i0.ɵɵtext(1, \" El email es \");\n    i0.ɵɵelementStart(2, \"strong\");\n    i0.ɵɵtext(3, \"requerido\");\n    i0.ɵɵelementEnd()();\n  }\n}\n\nfunction LoginComponent_mat_error_15_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-error\");\n    i0.ɵɵtext(1, \" Ingres\\u00E1 un email v\\u00E1lido \");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction LoginComponent_ng_template_28_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵtext(0, \"Contrase\\u00F1a\");\n  }\n}\n\nfunction LoginComponent_mat_error_38_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-error\");\n    i0.ɵɵtext(1, \" La contrase\\u00F1a es \");\n    i0.ɵɵelementStart(2, \"strong\");\n    i0.ɵɵtext(3, \"requerida\");\n    i0.ɵɵelementEnd()();\n  }\n}\n\nfunction LoginComponent_mat_error_39_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-error\");\n    i0.ɵɵtext(1, \" La contrase\\u00F1a debe contener al menos 6 caracteres \");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction LoginComponent_mat_error_40_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-error\");\n    i0.ɵɵtext(1, \" La contrase\\u00F1a debe contener al menos una letra \");\n    i0.ɵɵelementEnd();\n  }\n}\n\nconst _c0 = function () {\n  return [\"/register\"];\n};\n\nexport let LoginComponent = /*#__PURE__*/(() => {\n  class LoginComponent {\n    constructor(router, _authService, _alertsService) {\n      this.router = router;\n      this._authService = _authService;\n      this._alertsService = _alertsService;\n      this.hide = true;\n      this.createForms();\n    }\n\n    ngOnInit() {\n      this.checkLoginState();\n    }\n\n    createForms() {\n      this.emailFormGroup = new FormGroup({\n        email: new FormControl('', Validators.compose([Validators.required, Validators.pattern('^[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+.[a-zA-Z0-9-.]+$')])),\n        remember: new FormControl('')\n      });\n      this.passFormGroup = new FormGroup({\n        password: new FormControl('', Validators.compose([Validators.required, Validators.minLength(6), Validators.pattern('^(?=.*[a-zA-Z])[a-zA-Z0-9!$%@#£€*?&-_]+$')]))\n      });\n    }\n\n    onSubmitLogin() {\n      if (!this.passFormGroup.controls.password.errors) {\n        const user = {\n          email: this.emailFormGroup.value.email,\n          password: this.passFormGroup.value.password\n        };\n\n        this._authService.login(user).subscribe(res => {\n          if (res.success) {\n            this._alertsService.alertToast(res.msg, 'success').then(() => {\n              if (this.emailFormGroup.controls.remember.value) {\n                localStorage.setItem('remember', this.emailFormGroup.value.email);\n              } else {\n                localStorage.removeItem('remember');\n              }\n\n              this.router.navigateByUrl('dashboard');\n            });\n          }\n        }, err => {\n          let errorMsg = '';\n\n          if (err.error.msg) {\n            errorMsg = err.error.msg;\n          } else {\n            errorMsg = 'Lo sentimos, ha ocurrido un error. Intentá nuevamente.';\n          }\n\n          this._alertsService.alertToast(errorMsg, 'error');\n        });\n      }\n    } // CHECK LOGIN STATE\n\n\n    checkLoginState() {\n      const email = localStorage.getItem('remember');\n\n      if (email) {\n        this.emailFormGroup.reset({\n          email,\n          remember: true\n        });\n      }\n\n      this._authService.authSubject.subscribe(state => {\n        if (state.logged) {\n          this.router.navigateByUrl('dashboard');\n        }\n      });\n    }\n\n  }\n\n  LoginComponent.ɵfac = function LoginComponent_Factory(t) {\n    return new (t || LoginComponent)(i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i2.AuthService), i0.ɵɵdirectiveInject(i3.AlertsService));\n  };\n\n  LoginComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: LoginComponent,\n    selectors: [[\"app-login\"]],\n    decls: 48,\n    vars: 16,\n    consts: [[\"fxLayout\", \"row\", \"fxLayoutAlign\", \"center center\", 1, \"form-wrapper\"], [1, \"box\"], [\"linear\", \"\"], [\"stepper\", \"\"], [3, \"stepControl\"], [\"fxLayout\", \"column\", 3, \"formGroup\"], [\"matStepLabel\", \"\"], [1, \"field-full-width\"], [\"matInput\", \"\", \"formControlName\", \"email\", \"placeholder\", \"Ingres\\u00E1 tu email\"], [4, \"ngIf\"], [\"formControlName\", \"remember\", \"color\", \"primary\"], [3, \"routerLink\"], [1, \"buttons\"], [\"mat-raised-button\", \"\", \"color\", \"primary\", \"matStepperNext\", \"\"], [\"fxLayoutAlign\", \"start stretch\", \"mat-icon-button\", \"\", \"matSuffix\", \"\", \"matStepperPrevious\", \"\", 1, \"arrowBack\"], [\"matInput\", \"\", \"formControlName\", \"password\", \"placeholder\", \"Ingres\\u00E1 tu contrase\\u00F1a\", 3, \"type\"], [\"mat-icon-button\", \"\", \"matSuffix\", \"\", 3, \"click\"], [\"href\", \"#\"], [\"mat-raised-button\", \"\", \"color\", \"primary\", 3, \"click\"]],\n    template: function LoginComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0)(1, \"mat-card\", 1)(2, \"mat-card-header\")(3, \"mat-card-title\");\n        i0.ɵɵtext(4, \"Iniciar sesi\\u00F3n\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(5, \"mat-horizontal-stepper\", 2, 3)(7, \"mat-step\", 4)(8, \"form\", 5);\n        i0.ɵɵtemplate(9, LoginComponent_ng_template_9_Template, 1, 0, \"ng-template\", 6);\n        i0.ɵɵelementStart(10, \"mat-form-field\", 7);\n        i0.ɵɵelement(11, \"input\", 8);\n        i0.ɵɵelementStart(12, \"mat-hint\");\n        i0.ɵɵtext(13, \"usuario@email.com\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(14, LoginComponent_mat_error_14_Template, 4, 0, \"mat-error\", 9);\n        i0.ɵɵtemplate(15, LoginComponent_mat_error_15_Template, 2, 0, \"mat-error\", 9);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(16, \"mat-checkbox\", 10);\n        i0.ɵɵtext(17, \"Recordar usuario\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(18, \"p\");\n        i0.ɵɵtext(19, \"Cre\\u00E1 una cuenta nueva \");\n        i0.ɵɵelementStart(20, \"a\", 11)(21, \"strong\");\n        i0.ɵɵtext(22, \"aqu\\u00ED\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(23, \"div\", 12)(24, \"button\", 13);\n        i0.ɵɵtext(25, \"Siguiente\");\n        i0.ɵɵelementEnd()()()();\n        i0.ɵɵelementStart(26, \"mat-step\", 4)(27, \"form\", 5);\n        i0.ɵɵtemplate(28, LoginComponent_ng_template_28_Template, 1, 0, \"ng-template\", 6);\n        i0.ɵɵelementStart(29, \"button\", 14)(30, \"mat-icon\");\n        i0.ɵɵtext(31, \"arrow_back\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtext(32);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(33, \"mat-form-field\", 7);\n        i0.ɵɵelement(34, \"input\", 15);\n        i0.ɵɵelementStart(35, \"button\", 16);\n        i0.ɵɵlistener(\"click\", function LoginComponent_Template_button_click_35_listener() {\n          return ctx.hide = !ctx.hide;\n        });\n        i0.ɵɵelementStart(36, \"mat-icon\");\n        i0.ɵɵtext(37);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵtemplate(38, LoginComponent_mat_error_38_Template, 4, 0, \"mat-error\", 9);\n        i0.ɵɵtemplate(39, LoginComponent_mat_error_39_Template, 2, 0, \"mat-error\", 9);\n        i0.ɵɵtemplate(40, LoginComponent_mat_error_40_Template, 2, 0, \"mat-error\", 9);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(41, \"p\");\n        i0.ɵɵtext(42, \"Si olvidaste la contrase\\u00F1a \");\n        i0.ɵɵelementStart(43, \"a\", 17);\n        i0.ɵɵtext(44, \"ingres\\u00E1 aqu\\u00ED\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(45, \"div\", 12)(46, \"button\", 18);\n        i0.ɵɵlistener(\"click\", function LoginComponent_Template_button_click_46_listener() {\n          return ctx.onSubmitLogin();\n        });\n        i0.ɵɵtext(47, \"Ingresar\");\n        i0.ɵɵelementEnd()()()()()()();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(7);\n        i0.ɵɵproperty(\"stepControl\", ctx.emailFormGroup);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"formGroup\", ctx.emailFormGroup);\n        i0.ɵɵadvance(6);\n        i0.ɵɵproperty(\"ngIf\", ctx.emailFormGroup.controls.email.hasError(\"required\"));\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.emailFormGroup.controls.email.hasError(\"pattern\"));\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction0(15, _c0));\n        i0.ɵɵadvance(6);\n        i0.ɵɵproperty(\"stepControl\", ctx.passFormGroup);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"formGroup\", ctx.passFormGroup);\n        i0.ɵɵadvance(5);\n        i0.ɵɵtextInterpolate1(\" \", ctx.emailFormGroup.controls.email.value, \" \");\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"type\", ctx.hide ? \"password\" : \"text\");\n        i0.ɵɵadvance(1);\n        i0.ɵɵattribute(\"aria-label\", \"Hide password\")(\"aria-pressed\", ctx.hide);\n        i0.ɵɵadvance(2);\n        i0.ɵɵtextInterpolate(ctx.hide ? \"visibility_off\" : \"visibility\");\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.passFormGroup.controls.password.hasError(\"required\"));\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.passFormGroup.controls.password.hasError(\"minlength\"));\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.passFormGroup.controls.password.hasError(\"pattern\"));\n      }\n    },\n    directives: [i4.DefaultLayoutDirective, i4.DefaultLayoutAlignDirective, i5.MatCard, i5.MatCardHeader, i5.MatCardTitle, i6.MatStepper, i6.MatStep, i7.ɵNgNoValidate, i7.NgControlStatusGroup, i7.FormGroupDirective, i6.MatStepLabel, i8.MatFormField, i9.MatInput, i7.DefaultValueAccessor, i7.NgControlStatus, i7.FormControlName, i8.MatHint, i10.NgIf, i8.MatError, i11.MatCheckbox, i1.RouterLinkWithHref, i12.MatButton, i6.MatStepperNext, i6.MatStepperPrevious, i8.MatSuffix, i13.MatIcon],\n    styles: [\".mat-form-field[_ngcontent-%COMP%]{margin-top:16px}.mat-checkbox[_ngcontent-%COMP%]{margin-top:1rem;margin-left:.5rem}p[_ngcontent-%COMP%]{margin-top:2rem}button[_ngcontent-%COMP%]{width:100%}.buttons[_ngcontent-%COMP%]{margin-top:2rem}.arrowBack[_ngcontent-%COMP%]{margin-top:1rem}\"]\n  });\n  return LoginComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}